# Rosreest ETL

Загрузка из публичного дата-сета Росреестра данных о сделках купли-продажи квартир в базу данных PostgreSQL.

## Описание дата-сета

Наименование дата-сета: "Данные о ценах регистрируемых сделок (по отчуждению) с объектами недвижимости в разрезе территориальной принадлежности" за 2021 год.


Описание дата-сета https://rosreestr.gov.ru/open-service/data-sety-rosreestra/dannye-o-tsenakh-registriruemykh-sdelok-po-otchuzhdeniyu-s-obektami-nedvizhimosti-v-razreze-territorialnoy-prinadlezhnosti/


Дата-сет расположен в сети интернет по адресу https://files.kadastr.ru/s/RXcEoq2gqfKJRRF.


Дата-сет представляет собой набор файлов в подпапках по регионам. Всего 128,6 тысяч файлов общим размером 56,9 ГБ в формате json.

## Описание программы

`01_from_json_to_parquette.py` - извлекает данные и подготавливает к загрузке.
### Extract (извлечение)

 Обрабатывается только информация о сделках купли-продажи квартир (содержится в файлах формата `flat_ds2*.json`).

### Transform (преобразование)
+ Исключаются сделки в которых отсутствует информация о сумме сделки и площади квартиры либо сумма сделки или площадь равны 0. 
+ Исключены дублирующиеся строки. 
+ Исправлены ошибки, когда площадь указана как отрицательное число.

Добавлена информация об исходном файле из которого загружена информация.
Промежуточная информация сохраняется в файлах формата `Parquet`.

`02_from_parquette_to_psql.py` - загружает в базу данных из промежуточных файлов.

### Load (загрузка)

Загрузка в базу данных PostgreSQL.

Результирующая таблица в PostgreSQL содержит 19,6 млн. строк и занимает 6Гб.



